# ワーク: AWS StepFunctions のステートマシンを作成して実行してみよう

## このワーク環境は、ワーク実施時だけの一時的な環境になります。

---

## 手順

1. 講師のガイドにもとづき、AWS マネジメントコンソールにサインインしてください。

2. AWS StepFunctions のページを表示してください。

3. 以降の手順を実施して ステートマシンを作成、テストを実行して下さい。

4. ステートマシンの作成
  - [**ステートマシンの作成**] をクリック
  - **テンプレートの選択** で **Blank** を選択し、右下の **[選択]** をクリック
  - ページ左上にある [MyStateMachine-xxxx] の右横の鉛筆アイコンをクリック
  - **ステートマシン名**: `MyStateMachine-00`
    - **00部分をご自分の番号に変更して下さい。**
  - **アクセス許可** セクション
    - **実行ロール** で **StepFunctionsWork-role** を選択
  - ページ上部にある **[{} コード]** をクリック
  - ページ左側のコード入力部分に、このリポジトリにある WorkStateMachine.json のコードを上書きで貼り付け
  - [**作成**] をクリック
    
5. ステートマシンの実行
  - [**実行を開始**] をクリック
  - **実行を開始** ウィンドウで、**入力** に下記を入力して [**実行を開始**] をクリック
    - ```
      {
        "accountNumber": "12345678",
        "amount": "1000000"
      }
      ``` 
  - **グラフビュー** でステートマシンの実行状況を確認
  - **グラフビュー** 各ステートをクリック
    - 右側で **入力** や **出力** の内容を確認
  - ページ上部の [**新しい実行**] をクリックして 繰り返し 3 ～ 4 回実行
    - ステートマシンのフローが異なる場合があることを確認
    - (Load-Screening の結果がランダムになるように Lambda 関数を実装しています。)

---

* WorkStateMachine.json
  - ステートマシンのコード (Amazon State Language)
* sfn-Loan
  - ステートマシンから呼び出す Lambda 関数の AWS SAM リソース






